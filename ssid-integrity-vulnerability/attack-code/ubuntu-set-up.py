import os
import subprocess
import sys

def run_command(cmd, cwd=None):
    print(f"\n[+] Running: {cmd}")
    result = subprocess.run(cmd, shell=True, cwd=cwd)
    if result.returncode != 0:
        print(f"[!] Command failed: {cmd}")
        sys.exit(result.returncode)

def main():
    if os.geteuid() != 0:
        print("Please run this script with sudo or as root.")
        sys.exit(1)

    run_command("sudo apt-get update")

    packages = (
        "libnl-3-dev libnl-genl-3-dev libnl-route-3-dev libssl-dev "
        "libdbus-1-dev git pkg-config build-essential macchanger net-tools virtualenv"
    )
    run_command(f"apt-get install {packages}")

    repo_dir = "mc-mitm-ssid"
    run_command("sudo chmod +x pysetup.sh", cwd=repo_dir)
    run_command("sudo ./pysetup.sh", cwd=repo_dir)

    run_command("apt-get install iw")

    print("\nSetup complete!")

if __name__ == "__main__":
    main()
