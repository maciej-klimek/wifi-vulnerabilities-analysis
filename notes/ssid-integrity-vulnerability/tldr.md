# W skrócie

[SSID Confusion](https://papers.mathyvanhoef.com/wisec2024.pdf) - Praca opisuje błąd projektowy w Wi-Fi: klient może zostać zmuszony do połączenia się z inną siecią niż ta, którą wydaje mu się używać. Interfejs pokazuje znajomą nazwę (SSID), ale w rzeczywistości ruch idzie przez fałszywy punkt dostępowy kontrolowany przez atakującego. Po chłopsku - użytkownik sądzi, że jest w "TrustedNet", podczas gdy działa w "WrongNet".

## Na czym polega problem

Standard 802.11 nie gwarantuje wiarygodnego powiązania między nazwą sieci (SSID) a samą sesją/uwierzytelnianiem. W praktyce oznacza to, że nawet przy poprawnym haśle lub loginie nazwa sieci może zostać podmieniona albo wprowadzić klienta w błąd - bez mechanizmu, który pozwoliłby urządzeniu to wykryć.

## Co zostało zrobione / udowodnione

* Model ataku - fałszywy AP wystawia te same dane uwierzytelniające i manipuluje ramkami (beacon/probe/association), żeby klient skojarzył się z WrongNet, ale widział TrustedNet.
* Przeprowadzono testy praktyczne na wielu urządzeniach i systemach - atak działa w realnych warunkach.
* Zbadano podatność różnych mechanizmów (WPA2/WPA3/Enterprise/roaming) i określono scenariusze, w których atak ma największy efekt.
* Wykazano, że atak jest łatwiejszy, gdy różne SSID używają tych samych poświadczeń (np. te same loginy/hasła na różnych sieciach).

## Przykładowe skutki praktyczne

* Podsłuch / MITM ruchu użytkownika, wyłudzanie poświadczeń, przekierowania do fałszywych stron logowania.
* Automatyczne wyłączanie VPN - klient "myśli", że znajduje się w zaufanej sieci, co ułatwia przechwycenie ruchu.
* Zagrożenie dotyczy nie tylko środowisk domowych - również sieci korporacyjnych i uczelnianych (np. przy reuse poświadczeń między SSID).

## Najważniejsze obserwacje

* SSID nie jest zawsze uwierzytelniane ani związane z uwierzytelnianiem 802.11 w sposób niepodważalny.
* Klienci często nie weryfikują ciągłości SSID po nawiązaniu połączenia - można manipulować informacją o sieci "w locie".
* Ponowne użycie poświadczeń (wspólny login/hasło dla różnych SSID) znacząco zwiększa ryzyko ataku.

## Proponowane środki zaradcze (w dużym skrócie)

* Wprowadzić mechanizmy chroniące beacony/probe, tak by nazwa sieci była uwierzytelniona.
* Zmodyfikować protokół tak, żeby SSID było częścią danych uwierzytelniających - powiązać SSID z handshake'em.
* Unikać ponownego użycia tych samych poświadczeń między różnymi SSID (szczególnie w środowiskach enterprise/eduroam).
* Na poziomie klienta - preferować wiązanie do konkretnego BSSID (adresu AP) lub wymuszać dodatkową weryfikację połączenia zamiast polegać tylko na samej nazwie.

## tldr konkluzja

To nie jest zwykły "evil-twin" - to fundamentalna słabość w sposobie, w jaki klienci interpretują i wiążą nazwę sieci z sesją. Skutki są realne - od przechwycenia ruchu po obejście VPN-ów czy ataki na poświadczenia. Rozwiązanie wymaga zmian w standardzie oraz lepszych praktyk konfiguracyjnych.
